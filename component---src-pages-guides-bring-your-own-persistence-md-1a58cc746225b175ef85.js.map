{"version":3,"sources":["webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.js","webpack:///./node_modules/gatsby-theme-carbon/src/templates/Default.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.module.scss","webpack:///./src/pages/guides/BringYourOwnPersistence.md","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.module.scss"],"names":["children","title","tabs","shouldHideHeader","className","cx","id","text","relativePagePath","repositoryProp","repository","baseUrl","href","row","render","this","slug","currentTab","pageTabs","tab","slugifiedTab","slugify","lower","selected","key","to","tabsContainer","list","React","Component","pageContext","location","frontmatter","scrollDirection","useScrollDirection","pathPrefix","homepage","label","padded","module","exports","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"gQAEA,ECQmB,SAAC,GAAD,MAAGA,EAAH,WAAaC,EAAb,iBAAoBC,OAApB,WAA+BC,EAA/B,0BACjB,mBACEC,UAAWC,KAAE,wDAESH,EAFT,qCAMb,mBAAKE,UAAU,YACb,mBAAKA,UAAU,WACb,mBAAKA,UAAU,iBACb,kBAAIE,GAAJ,aAAoBF,UAAWG,QAVvC,MADiB,I,wBCRnB,ECIiB,SAAC,GAAsD,IAApDC,EAAmD,EAAnDA,iBAA8BC,EAAqB,EAAjCC,WAGhBA,EAHiD,sCAkBnCD,GAlBmC,EAkB7DE,EAlB6D,UAoB/DC,EAAUD,EAAN,eApB2D,eAoB3D,aAAV,EAEA,OAAOA,EACL,mBAAKP,UAAS,WAAaS,OACzB,mBAAKT,UAAU,WACb,iBAAGA,UAAH,OAAoBQ,KAAMA,GAHlB,8BAAd,M,wCC1BF,E,gLCkBEE,kBAAU,IAAD,EACgBC,KADhB,MACCb,EADD,OACOc,EADP,OAEDC,EAAaD,uCAAnB,GAKME,EAAWhB,EAAA,KAAS,SAAAiB,GAAQ,IAAD,EACzBC,EAAeC,IAAQF,EAAK,CAAEG,OAAO,IACrCC,EAAWH,IAAjB,EACMR,EAAOI,YAAb,GACA,OACE,kBAAIQ,IAAJ,EAAcpB,UAAWC,KAAE,yCACzB,oBAAMD,UAAN,OAAuBqB,GAAE,GAAKb,GAFlC,OASF,OACE,mBAAKR,UAAWsB,iBACd,mBAAKtB,UAAU,YACb,mBAAKA,UAAU,WACb,mBAAKA,UAAU,mCACb,uBACE,kBAAIA,UAAWuB,QAN3B,S,GA1BkCC,IAAMC,W,YCsD5C,IAtDgB,SAAC,GAAyC,IAAvCC,EAAsC,EAAtCA,YAAa9B,EAAyB,EAAzBA,SAAU+B,EAAe,EAAfA,SAAe,EACRD,EADQ,YAC/CE,OAD+C,WAC7BxB,EAAqBsB,EADQ,iBAE/C5B,EAAgB8B,EAF+B,KAEzC/B,EAAU+B,EAF+B,MAGjDC,EAAkBC,cAClB/B,IAAmB,GAJ8B,SAIpB8B,EAIzBE,EAR6C,uBAkBjDnB,EAAOmB,EACTJ,qBADmB,IAEnBA,EAFJ,SASMd,EAJJ,EACOD,2BAAgCK,IAAQnB,EAAD,GAAU,CAAEoB,OAAO,IADhD,GAKnB,OACE,iBAAQnB,iBAAR,EAA4CiC,UAAU,GACpD,eACEjC,iBADF,EAEEF,MAFF,EAGEoC,MAHF,QAIEnC,KAAMA,GAELA,GAAQ,eAAUc,KAAV,EAAsBd,KAAtB,EAAkCe,WAAYA,KAEzD,iBAAMqB,QAAM,GAAZ,EAEE,eAAU9B,iBAAkBA,KAE9B,iBACEsB,YADF,EAEEC,SAFF,EAGEf,KAHF,EAIEd,KAJF,EAKEe,WAAYA,IAEd,gBArBJ,S,qBCzCFsB,EAAOC,QAAU,CAAC,kBAAoB,iDAAiD,oBAAsB,mDAAmD,KAAO,+BAA+B,IAAM,gC,qBCA5MD,EAAOC,QAAU,CAAC,kBAAoB,iDAAiD,oBAAsB,mDAAmD,cAAgB,yCAAyC,KAAO,+BAA+B,SAAW,oCAAoC,KAAO,+BAA+B,aAAe,0C,+aCK5V,IAAMC,EAAe,GAOtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,E,oIACF,mBACD,OAAO,YAACJ,EAAD,KAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,iBAAQ,CACN,GAAM,YADR,YAGA,yQAGA,iBAAQ,CACN,GAAM,cADR,cAGA,wEAAuD,0BAAYC,WAAW,KAAvB,oBAAvD,aACA,sBACE,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,yHADQ,mBAApB,2EAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,gIADQ,0BAApB,gFAIF,iBAAQ,CACN,GAAM,UADR,UAGA,2FAA0E,0BAAYA,WAAW,KAAvB,4CAA1E,gBAA+K,0BAAYA,WAAW,KAAvB,2BAA/K,KACA,yCAAwB,0BAAYA,WAAW,KAAvB,4DAAxB,+HAA4P,0BAAYA,WAAW,KAAvB,kDAA5P,mDAA0Y,0BAAYA,WAAW,KAAvB,4BAA1Y,8CACA,iBAAQ,CACN,GAAM,kDADR,kDAGA,4OAEA,sBACE,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,2BACpB,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,wBACpB,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,4BACpB,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,2BAEtB,4BAAW,0BAAYA,WAAW,KAAvB,0BAAX,sNAAoS,0BAAYA,WAAW,KAAvB,yBAApS,oDAA0Z,0BAAYA,WAAW,KAAvB,sBAA1Z,yDAAkhB,0BAAYA,WAAW,KAAvB,0BAAlhB,gFAAqqB,0BAAYA,WAAW,KAAvB,iBAArqB,oCAAmwB,0BAAYA,WAAW,KAAvB,cAAnwB,sHACA,4BAAW,0BAAYA,WAAW,KAAvB,uBAAX,2LAAsQ,0BAAYA,WAAW,KAAvB,mCAAtQ,QAA0V,0BAAYA,WAAW,KAAvB,qCAA1V,oGACA,4BAAW,0BAAYA,WAAW,KAAvB,2BAAX,wJAAuO,0BAAYA,WAAW,KAAvB,0BAAvO,2OAEA,oMAEA,uIACA,qCAAoB,0BAAYA,WAAW,KAAvB,yBAApB,uDAA6I,0BAAYA,WAAW,KAAvB,mBAA7I,6NAC2M,0BAAYA,WAAW,KAAvB,0BAD3M,8HAEA,iBAAQ,CACN,GAAM,uCADR,uCAGA,gbAEA,8KACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,2sBAmBL,sDAAqC,0BAAYA,WAAW,KAAvB,yBAArC,uBACA,iBAAQ,CACN,GAAM,8CADR,8CAGA,qCAAoB,mBAAGA,WAAW,KAAQ,CACtC,KAAQ,gBADQ,SAApB,0YAGA,4DAA2C,mBAAGA,WAAW,KAAQ,CAC7D,KAAQ,mDAD+B,8DAA3C,gIAEwM,0BAAYA,WAAW,KAAvB,SAFxM,QAEkQ,0BAAYA,WAAW,KAAvB,WAFlQ,+FAG0E,0BAAYA,WAAW,KAAvB,UAH1E,QAGqI,0BAAYA,WAAW,KAAvB,UAHrI,oNAKA,0GAAyF,0BAAYA,WAAW,KAAvB,UAAzF,wEAAoN,0BAAYA,WAAW,KAAvB,qCAApN,QAA0S,0BAAYA,WAAW,KAAvB,uBAA1S,iBACA,iBAAQ,CACN,GAAM,UADR,UAGA,qMAAoL,0BAAYA,WAAW,KAAvB,eAApL,KAAiP,0BAAYA,WAAW,KAAvB,4BAAjP,SAA+T,0BAAYA,WAAW,KAAvB,2BAA/T,uIACA,2BAAU,0BAAYA,WAAW,KAAvB,gCAAV,wBAA2G,0BAAYA,WAAW,KAAvB,iCAA3G,6EACA,2BAAU,0BAAYA,WAAW,KAAvB,gCAAV,yBAA4G,0BAAYA,WAAW,KAAvB,gCAA5G,iHACA,iBAAQ,CACN,GAAM,QADR,QAGA,4WACoM,0BAAYA,WAAW,KAAvB,2CADpM,MAEA,iDAAgC,0BAAYA,WAAW,KAAvB,gCAAhC,4BAAqI,0BAAYA,WAAW,KAAvB,iCAArI,4FACA,8GACA,sBACE,kBAAIA,WAAW,MAAf,yHACA,kBAAIA,WAAW,MAAf,wGAEF,iFAAgE,0BAAYA,WAAW,KAAvB,wBAAhE,2GACA,iFAAgE,0BAAYA,WAAW,KAAvB,wBAAhE,eAAgJ,mBAAGA,WAAW,KAAQ,CAClK,KAAQ,2CADoI,0CAAhJ,KAGA,iBAAQ,CACN,GAAM,gBADR,gBAGA,oNACA,iBAAQ,CACN,GAAM,UADR,UAGA,8LAA6K,0BAAYA,WAAW,KAAvB,4BAA7K,QAA0P,0BAAYA,WAAW,KAAvB,2BAA1P,sMAAogB,0BAAYA,WAAW,KAAvB,8CAApgB,oCACA,2OACA,oFAAmE,0BAAYA,WAAW,KAAvB,qDAAnE,oGACA,iBAAQ,CACN,GAAM,UADR,UAGA,4UAC6J,0BAAYA,WAAW,KAAvB,4BAD7J,QAC0O,0BAAYA,WAAW,KAAvB,2BAD1O,0GAEA,iLACA,iBAAQ,CACN,GAAM,WADR,WAGA,ugBAAsf,0BAAYA,WAAW,KAAvB,2CAAtf,MACA,gNACwE,0BAAYA,WAAW,KAAvB,SADxE,6BAEA,sPAAqO,0BAAYA,WAAW,KAAvB,wCAArO,6CAAmW,0BAAYA,WAAW,KAAvB,4CAAnW,2IACA,iBAAQ,CACN,GAAM,UADR,UAGA,4BAAW,mBAAGA,WAAW,KAAQ,CAC7B,KAAQ,4CADD,6BAAX,8PAGS,0BAAYA,WAAW,KAAvB,oCAHT,kEAIA,wOACwD,0BAAYA,WAAW,KAAvB,YADxD,KACkH,0BAAYA,WAAW,KAAvB,eADlH,KAC+K,0BAAYA,WAAW,KAAvB,SAD/K,wKAE+E,mBAAGA,WAAW,KAAQ,CACjG,KAAQ,2DADmE,eAF/E,gCAIyD,mBAAGA,WAAW,KAAQ,CAC3E,KAAQ,qDAD6C,sBAJzD,6GAOI,0BAAYA,WAAW,KAAvB,8DAPJ,0BAQA,qOAC8F,0BAAYA,WAAW,KAAvB,wCAD9F,0BAEA,wCAAuB,0BAAYA,WAAW,KAAvB,+BAAvB,oBAAmH,0BAAYA,WAAW,KAAvB,gCAAnH,mFACA,wCAAuB,0BAAYA,WAAW,KAAvB,+BAAvB,qBAAoH,0BAAYA,WAAW,KAAvB,+BAApH,+EACA,iBAAQ,CACN,GAAM,kCADR,kCAGA,oEAAmD,0BAAYA,WAAW,KAAvB,oBAAnD,qFACA,yLACe,0BAAYA,WAAW,KAAvB,wCADf,0HAC0N,0BAAYA,WAAW,KAAvB,8CAD1N,0EAC2X,0BAAYA,WAAW,KAAvB,mDAD3X,KAEA,6EAA4D,0BAAYA,WAAW,KAAvB,6CAA5D,kBAAoK,0BAAYA,WAAW,KAAvB,uCAApK,KACA,uHAAsG,0BAAYA,WAAW,KAAvB,oBAAtG,wKAKJJ,EAAWK,gBAAiB,G,qBCnL5BX,EAAOC,QAAU,CAAC,kBAAoB,mDAAmD,oBAAsB,qDAAqD,WAAa,wCAAwC,KAAO,iCAAiC,iBAAmB,gDAAgD,kBAAoB,mD","file":"component---src-pages-guides-bring-your-own-persistence-md-1a58cc746225b175ef85.js","sourcesContent":["import PageHeader from './PageHeader';\n\nexport default PageHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport {\n  pageHeader,\n  text,\n  pageHeaderSticky,\n  pageHeaderShifted,\n} from './PageHeader.module.scss';\n\nconst PageHeader = ({ children, title, tabs = [], shouldHideHeader }) => (\n  <div\n    className={cx({\n      [pageHeader]: pageHeader,\n      [pageHeaderSticky]: tabs.length,\n      [pageHeaderShifted]: shouldHideHeader,\n    })}\n  >\n    <div className=\"bx--grid\">\n      <div className=\"bx--row\">\n        <div className=\"bx--col-lg-12\">\n          <h1 id=\"page-title\" className={text}>\n            {title}\n          </h1>\n        </div>\n      </div>\n    </div>\n    {children}\n  </div>\n);\n\nPageHeader.propTypes = {\n  /**\n   * Pass in the children that will be rendered within the PageHeader\n   */\n  children: PropTypes.node,\n\n  /**\n   * Specify the title for the page\n   */\n  title: PropTypes.string,\n};\n\nexport default PageHeader;\n","import EditLink from './EditLink';\n\nexport default EditLink;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql, useStaticQuery } from 'gatsby';\n\nimport { link, row } from './EditLink.module.scss';\n\nconst EditLink = ({ relativePagePath, repository: repositoryProp }) => {\n  const {\n    site: {\n      siteMetadata: { repository },\n    },\n  } = useStaticQuery(graphql`\n    query REPOSITORY_QUERY {\n      site {\n        siteMetadata {\n          repository {\n            baseUrl\n            subDirectory\n          }\n        }\n      }\n    }\n  `);\n\n  const { baseUrl, subDirectory } = repositoryProp || repository;\n\n  const href = `${baseUrl}/tree/master${subDirectory}/src/pages${relativePagePath}`;\n\n  return baseUrl ? (\n    <div className={`bx--row ${row}`}>\n      <div className=\"bx--col\">\n        <a className={link} href={href}>\n          Edit this page on GitHub\n        </a>\n      </div>\n    </div>\n  ) : null;\n};\n\nEditLink.propTypes = {\n  repository: PropTypes.shape({\n    baseUrl: PropTypes.string,\n    subDirectory: PropTypes.string,\n  }),\n  relativePagePath: PropTypes.string,\n};\n\nexport default EditLink;\n","import PageTabs from './PageTabs';\n\nexport default PageTabs;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'gatsby';\nimport slugify from 'slugify';\nimport cx from 'classnames';\n\nimport {\n  tabsContainer,\n  list,\n  selectedItem,\n  listItem,\n  link,\n} from './PageTabs.module.scss';\n\nexport default class PageTabs extends React.Component {\n  static propTypes = {\n    tabs: PropTypes.array,\n    slug: PropTypes.string,\n  };\n\n  render() {\n    const { tabs, slug } = this.props;\n    const currentTab = slug\n      .split('/')\n      .filter(Boolean)\n      .slice(-1)[0];\n\n    const pageTabs = tabs.map(tab => {\n      const slugifiedTab = slugify(tab, { lower: true });\n      const selected = slugifiedTab === currentTab;\n      const href = slug.replace(currentTab, slugifiedTab);\n      return (\n        <li key={tab} className={cx({ [selectedItem]: selected }, listItem)}>\n          <Link className={link} to={`${href}`}>\n            {tab}\n          </Link>\n        </li>\n      );\n    });\n\n    return (\n      <div className={tabsContainer}>\n        <div className=\"bx--grid\">\n          <div className=\"bx--row\">\n            <div className=\"bx--col-lg-12 bx--col-no-gutter\">\n              <nav>\n                <ul className={list}>{pageTabs}</ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { WebsiteBackToTopBtn } from '@carbon/addons-website';\nimport slugify from 'slugify';\nimport { useStaticQuery, graphql } from 'gatsby';\n\nimport { useScrollDirection } from '../util/hooks';\n\nimport Layout from '../components/Layout';\nimport PageHeader from '../components/PageHeader';\nimport EditLink from '../components/EditLink';\nimport NextPrevious from '../components/NextPrevious';\nimport PageTabs from '../components/PageTabs';\nimport Main from '../components/Main';\n\nconst Default = ({ pageContext, children, location }) => {\n  const { frontmatter = {}, relativePagePath } = pageContext;\n  const { tabs, title } = frontmatter;\n  const scrollDirection = useScrollDirection();\n  const shouldHideHeader = !!tabs && scrollDirection === 'down';\n\n  // get the path prefix if it exists\n  const {\n    site: { pathPrefix },\n  } = useStaticQuery(graphql`\n    query PATH_PREFIX_QUERY {\n      site {\n        pathPrefix\n      }\n    }\n  `);\n\n  // let gatsby handle prefixing\n  const slug = pathPrefix\n    ? location.pathname.replace(pathPrefix, '')\n    : location.pathname;\n\n  const getCurrentTab = () => {\n    if (!tabs) return '';\n    return slug.split('/').slice(-1)[0] || slugify(tabs[0], { lower: true });\n  };\n\n  const currentTab = getCurrentTab();\n  return (\n    <Layout shouldHideHeader={shouldHideHeader} homepage={false}>\n      <PageHeader\n        shouldHideHeader={shouldHideHeader}\n        title={title}\n        label=\"label\"\n        tabs={tabs}\n      >\n        {tabs && <PageTabs slug={slug} tabs={tabs} currentTab={currentTab} />}\n      </PageHeader>\n      <Main padded>\n        {children}\n        <EditLink relativePagePath={relativePagePath} />\n      </Main>\n      <NextPrevious\n        pageContext={pageContext}\n        location={location}\n        slug={slug}\n        tabs={tabs}\n        currentTab={currentTab}\n      />\n      <WebsiteBackToTopBtn />\n    </Layout>\n  );\n};\n\nexport default Default;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"EditLink-module--bx--text-truncate--end--2pqje\",\"bxTextTruncateFront\":\"EditLink-module--bx--text-truncate--front--3_lIE\",\"link\":\"EditLink-module--link--1qzW3\",\"row\":\"EditLink-module--row--1B9Gk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageTabs-module--bx--text-truncate--end--267NA\",\"bxTextTruncateFront\":\"PageTabs-module--bx--text-truncate--front--3xEQF\",\"tabsContainer\":\"PageTabs-module--tabs-container--8N4k0\",\"list\":\"PageTabs-module--list--3eFQc\",\"listItem\":\"PageTabs-module--list-item--nUmtD\",\"link\":\"PageTabs-module--link--1mDJ1\",\"selectedItem\":\"PageTabs-module--selected-item--YPVr3\"};","import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/FHIR/FHIR/fhir/docs/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2 {...{\n      \"id\": \"overview\"\n    }}>{`Overview`}</h2>\n    <p>{`The IBM FHIR Server ships with a JDBC persistence layer that works with IBM Db2 and Apache Derby.\nHowever, based on the modular design, its possible to add support for other relational databases and/or\nplug in any other persistence layer.`}</p>\n    <h3 {...{\n      \"id\": \"interfaces\"\n    }}>{`Interfaces`}</h3>\n    <p>{`Persistence layer interfaces are defined in the `}<inlineCode parentName=\"p\">{`fhir-persistence`}</inlineCode>{` project.`}</p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://github.com/IBM/FHIR/blob/master/fhir-persistence/src/main/java/com/ibm/fhir/persistence/FHIRPersistence.java\"\n        }}>{`FHIRPersistence`}</a>{` defines the contract between the REST layer and the persistence layer.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://github.com/IBM/FHIR/blob/master/fhir-persistence/src/main/java/com/ibm/fhir/persistence/FHIRPersistenceFactory.java\"\n        }}>{`FHIRPersistenceFactory`}</a>{` is the interface for providing instances of FHIRPersistence to the server.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"config\"\n    }}>{`Config`}</h3>\n    <p>{`Which persistence layer is used by the server is determined by the `}<inlineCode parentName=\"p\">{`/fhirServer/persistence/factoryClassname`}</inlineCode>{` property in `}<inlineCode parentName=\"p\">{`fhir-server-config.json`}</inlineCode>{`.`}</p>\n    <p>{`When the default `}<inlineCode parentName=\"p\">{`com.ibm.fhir.persistence.jdbc.FHIRPersistenceJDBCFactory`}</inlineCode>{` is used, the returned FHIRPersistenceJDBCImpl instance will look up a corresponding datasource name using the value of the `}<inlineCode parentName=\"p\">{`fhirServer/persistence/jdbc/dataSourceJndiName`}</inlineCode>{` property in the tenant-specific configuration (`}<inlineCode parentName=\"p\">{`jdbc/fhirProxyDataSource`}</inlineCode>{` by default) and establish the connection.`}</p>\n    <h2 {...{\n      \"id\": \"adding-support-for-another-relational-database\"\n    }}>{`Adding support for another relational database`}</h2>\n    <p>{`Adding a new relational database type is not for the faint of heart, but the IBM FHIR Server team is here to help!\nTo add support for an alternative relational database, there are multiple projects to consider:`}</p>\n    <ol>\n      <li parentName=\"ol\"><inlineCode parentName=\"li\">{`fhir-persistence-proxy`}</inlineCode></li>\n      <li parentName=\"ol\"><inlineCode parentName=\"li\">{`fhir-database-utils`}</inlineCode></li>\n      <li parentName=\"ol\"><inlineCode parentName=\"li\">{`fhir-persistence-schema`}</inlineCode></li>\n      <li parentName=\"ol\"><inlineCode parentName=\"li\">{`fhir-persistence-jdbc`}</inlineCode></li>\n    </ol>\n    <p>{`The `}<inlineCode parentName=\"p\">{`fhir-persistence-proxy`}</inlineCode>{` project provides the default DataSource used by the IBM FHIR Server, but its just a wrapper for the XADataSources provided by the packaged JDBC drivers. To extend this class for a new database type, extend the `}<inlineCode parentName=\"p\">{`datasourceTypeMapping`}</inlineCode>{` with a mapping from your own type name (used in `}<inlineCode parentName=\"p\">{`fhir-server-config`}</inlineCode>{`) to a classname from your driver that implements the `}<inlineCode parentName=\"p\">{`javax.sql.XADataSource`}</inlineCode>{` interface). Note that the proxy jar and your driver must be packaged in the `}<inlineCode parentName=\"p\">{`fhirSharedLib`}</inlineCode>{` library defined in the server’s `}<inlineCode parentName=\"p\">{`server.xml`}</inlineCode>{` in order to use liberty-managed transactions (e.g. for performing a transaction that spans multiple datasources).`}</p>\n    <p>{`The `}<inlineCode parentName=\"p\">{`fhir-database-utils`}</inlineCode>{` project provides generic utilities for defining a PhysicalDataModel and applying it to a target database via the IDatabaseAdapter and IVersionHistoryService interfaces. Check out the `}<inlineCode parentName=\"p\">{`com.ibm.fhir.database.utils.db2`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`com.ibm.fhir.database.utils.derby`}</inlineCode>{` packages to understand how you might extend the framework with support for a new database type.`}</p>\n    <p>{`The `}<inlineCode parentName=\"p\">{`fhir-persistence-schema`}</inlineCode>{` project is used to programmatically construct DDL statements and execute them against a target database. This project uses the generic utilities in `}<inlineCode parentName=\"p\">{`fhir-persistence-utils`}</inlineCode>{` to deploy both an admin schema (used for tenant provisioning and schema versioning) and an application schema for the FHIR data.\nPresently, this project is written for use with a Db2 database, but it should be possible to either:`}</p>\n    <p>{`A. Print the DDL and manually tweak it for your desired database; or\nB. Add some kind of configuration to control which IDatabaseAdapter and IDatabaseTranslator are used.`}</p>\n    <p>{`Note that the Db2 implementation makes use of stored procedures whereas the derby implementation is pure JDBC.`}</p>\n    <p>{`Finally, the `}<inlineCode parentName=\"p\">{`fhir-persistence-jdbc`}</inlineCode>{` project provides the default implementation of the `}<inlineCode parentName=\"p\">{`FHIRPersistence`}</inlineCode>{` interface.\nThe project makes heavy use of Data Access Objects (DAO) and Data Transfer Objects (DTO) to abstract the details of the database. Most of the code is common across database types, but there is a branch in `}<inlineCode parentName=\"p\">{`ResourceDAOImpl.insert`}</inlineCode>{` which corresponds to the differences between the IBM Db2 (stored procedure) and Apache Derby (pure JDBC) implementations.`}</p>\n    <h2 {...{\n      \"id\": \"building-your-own-persistence-layer\"\n    }}>{`Building your own persistence layer`}</h2>\n    <p>{`Most FHIR projects are interoperability projects—the data already exists in some datastore.\nDue to performance considerations and the complexities of the FHIR API (especially search), we generally recommend converting that data to FHIR and storing it in the FHIR server’s database. However, in some cases, it might be better to configure the FHIR server to work directly with an existing datastore or APIs.`}</p>\n    <p>{`If you are using Maven, add the following dependencies to your persistence layer project (replacing the version variables with your desired version):`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`        <dependency>\n            <groupId>com.ibm.fhir</groupId>\n            <artifactId>fhir-persistence</artifactId>\n            <version>\\${fhir.persistence.version}</version>\n        </dependency>\n        <dependency>\n            <groupId>com.ibm.fhir</groupId>\n            <artifactId>fhir-persistence</artifactId>\n            <version>\\${fhir.persistence.version}</version>\n            <type>test-jar</type>\n            <scope>test</scope>\n        </dependency>\n        <dependency>\n            <groupId>com.ibm.fhir</groupId>\n            <artifactId>fhir-examples</artifactId>\n            <version>\\${fhir.examples.version}</version>\n            <scope>test</scope>\n        </dependency>\n`}</code></pre>\n    <p>{`You might also want to set up `}<inlineCode parentName=\"p\">{`fhir-persistence-jdbc`}</inlineCode>{` to use an example.`}</p>\n    <h3 {...{\n      \"id\": \"implementing-the-fhirpersistence-interface\"\n    }}>{`Implementing the FHIRPersistence Interface`}</h3>\n    <p>{`As described `}<a parentName=\"p\" {...{\n        \"href\": \"#interfaces\"\n      }}>{`above`}</a>{`, implementing your own persistence layer boils down to configuring the server to use your own FHIRPersistenceFactory and returning your own implementation of FHIRPersistence. The REST layer processes HTTP requests and distills them into one or more calls to this instance. Parameters are passed via a combination of the passed FHIRPersistenceContext and the ThreadLocal FHIRRequestContext.`}</p>\n    <p>{`Although the HL7 FHIR specification `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.hl7.org/fhir/R4/http.html#versions\"\n      }}>{`doesn’t strictly require all servers to support versioning`}</a>{`, the IBM FHIR Server is built to be version-aware. This means that all FHIRPersistence implementations should implement the `}<inlineCode parentName=\"p\">{`vread`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`history`}</inlineCode>{` interactions.\nSimilarly, the IBM FHIR Server was written for read/write datastores and so `}<inlineCode parentName=\"p\">{`create`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`update`}</inlineCode>{` should be supported as well.\nIf you have a use case for a read-only or non-version-aware server, please contact us and consider contributing the necessary modifications to the server to make this supported.`}</p>\n    <p>{`The IBM FHIR Server does support persistence implementations which do not support `}<inlineCode parentName=\"p\">{`delete`}</inlineCode>{` or transactions (e.g. for transaction bundles), so please implement `}<inlineCode parentName=\"p\">{`FHIRPersistence.isTransactional()`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`isDeleteSupported()`}</inlineCode>{` accordingly.`}</p>\n    <h4 {...{\n      \"id\": \"create\"\n    }}>{`Create`}</h4>\n    <p>{`Create requests include a FHIRPersistenceContext and an already-validated instance of the resource to create. FHIRPersistence implementations are responsible for adding the `}<inlineCode parentName=\"p\">{`Resource.id`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`Resource.meta.lastUpdate`}</inlineCode>{`, and `}<inlineCode parentName=\"p\">{`Resource.meta.versionId`}</inlineCode>{` elements to the resource before storing it. Implementations must return a SingleResourceResult with the result of the interaction.`}</p>\n    <p>{`If `}<inlineCode parentName=\"p\">{`SingleResourceResult.success`}</inlineCode>{` is set to true, the `}<inlineCode parentName=\"p\">{`SingleResourceResult.resource`}</inlineCode>{` should be a copy of the saved resource (with the added fields included).`}</p>\n    <p>{`If `}<inlineCode parentName=\"p\">{`SingleResourceResult.success`}</inlineCode>{` is set to false, the `}<inlineCode parentName=\"p\">{`SingleResourceResult.outcome`}</inlineCode>{` should be an OperationOutcome with a list of one or more issues that prevented the success of the operation.`}</p>\n    <h4 {...{\n      \"id\": \"read\"\n    }}>{`Read`}</h4>\n    <p>{`Read requests include a FHIRPersistenceContext, a Class object for the resource type being read, and the logical id of the resource to read.\nImplementations should check the FHIRSearchContext of the FHIRPersistenceContext to determine whether the caller would like the full resource back, the resource text or data, or just a summary (see `}<inlineCode parentName=\"p\">{`FHIRSearchContext.getSummaryParameter()`}</inlineCode>{`).`}</p>\n    <p>{`For successful requests, `}<inlineCode parentName=\"p\">{`SingleResourceResult.success`}</inlineCode>{` must be set to true and `}<inlineCode parentName=\"p\">{`SingleResourceResult.resource`}</inlineCode>{` must include a `}{`[potentially filtered]`}{` resource of the type passed in the request.`}</p>\n    <p>{`For unsuccessful requests, the implementation should return an appropriate Exception:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`FHIRPersistenceResourceNotFoundException if the resource with this id could not be found for the passed resource type`}</li>\n      <li parentName=\"ul\">{`FHIRPersistenceResourceDeletedException if the latest version of this resource is marked as deleted`}</li>\n    </ul>\n    <p>{`For all other errors, the implementation should return a `}<inlineCode parentName=\"p\">{`SingleResourceResult`}</inlineCode>{` with a success status of false and a non-null outcome with one or more issues to indicate the failure.`}</p>\n    <p>{`Note: we plan to deprecate these exceptions and use only `}<inlineCode parentName=\"p\">{`SingleResourceResult`}</inlineCode>{` as part of `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/IBM/FHIR/issues/194\"\n      }}>{`https://github.com/IBM/FHIR/issues/194`}</a>{`.`}</p>\n    <h4 {...{\n      \"id\": \"version-read\"\n    }}>{`Version read`}</h4>\n    <p>{`Version read requests work just like read requests except that the caller passes a version identifier and the persistence implementation must return that specific version of the resource.`}</p>\n    <h4 {...{\n      \"id\": \"update\"\n    }}>{`Update`}</h4>\n    <p>{`Update requests include a FHIRPersistenceContext, a resource logical id, and an updated version of the resource to save. FHIRPersistence implementations must set the `}<inlineCode parentName=\"p\">{`Resource.meta.lastUpdate`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`Resource.meta.versionId`}</inlineCode>{` elements before storing it. Typically, implementations will set the version of the updated resource based on the previous version of the resource which can be found in the FHIRPersistenceEvent (`}<inlineCode parentName=\"p\">{`FHIRPersistenceEvent.getPrevFhirResource()`}</inlineCode>{`) of the FHIRPersistenceContext.`}</p>\n    <p>{`Note: at the REST layer, an update request will first invoke read and then invoke update. Similarly, PATCH requests are converted to normal updates before reaching the persistence layer’s update implementation.`}</p>\n    <p>{`FHIRPersistence implementations SHOULD use the value of the `}<inlineCode parentName=\"p\">{`fhirServer/persistence/common/updateCreateEnabled`}</inlineCode>{` property to determine whether they should allow an update to a resource that doesn’t exist yet.`}</p>\n    <h4 {...{\n      \"id\": \"delete\"\n    }}>{`Delete`}</h4>\n    <p>{`Delete requests include a FHIRPersistenceContext, a Class object for the resource type being deleted, and the logical id of the resource to delete.\nFHIRPersistence implementations are expected to be version-aware and therefore must perform a “soft” delete, handling the delete like an update by setting the `}<inlineCode parentName=\"p\">{`Resource.meta.lastUpdate`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`Resource.meta.versionId`}</inlineCode>{` elements along with some marker flag to indicate that this resource has been deleted at this version.`}</p>\n    <p>{`For implementations that do not implement delete, FHIRPersistence includes a default implementation which throws a FHIRPersistenceNotSupportedException.`}</p>\n    <h4 {...{\n      \"id\": \"history\"\n    }}>{`History`}</h4>\n    <p>{`The IBM FHIR Server currently only supports history at the resource instance level. History requests include a FHIRPersistenceContext with an embedded FHIRHistoryContext, a Class object for the resource type being requested, and the logical id of the resource for which to show the history. Implementations should also check the FHIRSearchContext of the FHIRPersistenceContext to determine whether the caller would like the full resources back, the resource text or data, or just a summary (see `}<inlineCode parentName=\"p\">{`FHIRSearchContext.getSummaryParameter()`}</inlineCode>{`).`}</p>\n    <p>{`FHIRHistoryContext extends FHIRPagingContext and provides the requested page size and page number to return.\nSimilarly, FHIRPersistence implementations should check and honor the the `}<inlineCode parentName=\"p\">{`since`}</inlineCode>{` attribute (when valued).`}</p>\n    <p>{`In addition to setting the MultiResourceResult success indicator and the resource version instances for the requested page, FHIRPersistence implementations must set the total number of versions for the requested resource (`}<inlineCode parentName=\"p\">{`FHIRPagingContext.setTotalCount(int)`}</inlineCode>{`) and a map of deleted resource versions (`}<inlineCode parentName=\"p\">{`FHIRHistoryContext.setDeletedResources()`}</inlineCode>{`) for the REST layer to properly construct the response bundle and accurately reflect which versions are deletes (rather than updates).`}</p>\n    <h4 {...{\n      \"id\": \"search\"\n    }}>{`Search`}</h4>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.hl7.org/fhir/R4/search.html\"\n      }}>{`FHIR Search specification`}</a>{` is sprawling and difficult to implement in its entirety. At the persistence layer, search requests will include a FHIRPersistenceContext with an embedded FHIRSearchContext and a Class object to indicate the resource type(s) to search on.\nA Class of `}<inlineCode parentName=\"p\">{`com.ibm.fhir.model.type.Resource`}</inlineCode>{` is passed for searches performed at the “whole-system” level.`}</p>\n    <p>{`The query parameters passed in the HTTP request are parsed at the REST layer and passed to the persistence layer in the form of a FHIRSearchContext.\nThe FHIRSearchContext separates “return” parameters (like `}<inlineCode parentName=\"p\">{`_include`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`_revinclude`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`_sort`}</inlineCode>{`, etc.) from search parameters and makes them available through dedicated getters.\nEach search parameter is parsed into a QueryParameter and a QueryParameterValue. `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.hl7.org/fhir/R4/compartmentdefinition.html\"\n      }}>{`Compartment`}</a>{` searches are converted into `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.hl7.org/fhir/R4/search.html#chaining\"\n      }}>{`chained parameters`}</a>{`, which are represented through nested QueryParameter objects within the outermost QueryParameter.\nCheck `}<inlineCode parentName=\"p\">{`com.ibm.fhir.search.util.SearchUtil.parseQueryParameters()`}</inlineCode>{` for more information.`}</p>\n    <p>{`FHIRSearchContext extends FHIRPagingContext and provides the requested page size and page number to return.\nFHIRPersistence implementations are responsible for setting the total number of search results (`}<inlineCode parentName=\"p\">{`FHIRPagingContext.setTotalCount(int)`}</inlineCode>{`) for the given query.`}</p>\n    <p>{`On success, set `}<inlineCode parentName=\"p\">{`MultiResourceResult.success`}</inlineCode>{` to true and set `}<inlineCode parentName=\"p\">{`MultiResourceResult.resource`}</inlineCode>{` to the list of resources `}{`[or resource summaries]`}{` for the requested page.`}</p>\n    <p>{`On failure, set `}<inlineCode parentName=\"p\">{`MultiResourceResult.success`}</inlineCode>{` to false and set `}<inlineCode parentName=\"p\">{`MultiResourceResult.outcome`}</inlineCode>{` to an OperationOutcome with one or more issues which indicate the failure.`}</p>\n    <h2 {...{\n      \"id\": \"testing-your-persistence-layer\"\n    }}>{`Testing your persistence layer`}</h2>\n    <p>{`In addition to defining the interfaces, the `}<inlineCode parentName=\"p\">{`fhir-persistence`}</inlineCode>{` project includes a set of tests that you can extend to test your implementation.`}</p>\n    <p>{`Most of the tests defined in this project relate to search, but they also exercise the create, update, and delete interactions in the process.\nThe tests in the `}<inlineCode parentName=\"p\">{`com.ibm.fhir.persistence.search.test`}</inlineCode>{` package are organized by search parameter type and they utilize tenant-specific search parameter definitions from the `}<inlineCode parentName=\"p\">{`fhir-persistence/src/test/resources/config`}</inlineCode>{` directory and search for fields on the generated example resources at `}<inlineCode parentName=\"p\">{`fhir-examples/src/main/resources/json/ibm/basic`}</inlineCode>{`.`}</p>\n    <p>{`For an example of how to extend these tests, see the `}<inlineCode parentName=\"p\">{`com.ibm.fhir.persistence.jdbc.search.test`}</inlineCode>{` package under `}<inlineCode parentName=\"p\">{`fhir-persistence-jdbc/src/test/java`}</inlineCode>{`.`}</p>\n    <p>{`Finally, the IBM FHIR Server contains a number of end-to-end (e2e) integration tests under the `}<inlineCode parentName=\"p\">{`fhir-server-test`}</inlineCode>{` project. These tests can be executed against a running server that is configured with your persistence layer to provide further confidence in your implementation.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageHeader-module--bx--text-truncate--end--mZWeX\",\"bxTextTruncateFront\":\"PageHeader-module--bx--text-truncate--front--3zvrI\",\"pageHeader\":\"PageHeader-module--page-header--3hIan\",\"text\":\"PageHeader-module--text--o9LFq\",\"pageHeaderSticky\":\"PageHeader-module--page-header--sticky--1ElAE\",\"pageHeaderShifted\":\"PageHeader-module--page-header--shifted--1sRXO\"};"],"sourceRoot":""}